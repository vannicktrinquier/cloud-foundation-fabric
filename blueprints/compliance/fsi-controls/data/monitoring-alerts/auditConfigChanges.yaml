auditConfigChanges:
  display_name: Audit Configuration Changes
  documentation:
    content: |-
      Log-based alerting policy in project ${project} detected audit configuration changes.
      This alert helps track GCP services audit log configuration changes to ensure appropriate audit logs are being collected. ``` protoPayload.methodName="SetIamPolicy" AND protoPayload.serviceData.policyDelta.auditConfigDeltas:* ```
    mime_type: text/markdown
  conditions:
  - display_name: 'Log match condition: audit configuration changes'
    condition_matched_log:
      filter: protoPayload.methodName="SetIamPolicy" AND protoPayload.serviceData.policyDelta.auditConfigDeltas:*
      label_extractors:
        principal: EXTRACT(protoPayload.authenticationInfo.principalEmail)
        method_name: EXTRACT(protoPayload.methodName)
        organization_id: EXTRACT(labels.organization_id)
        folder_id: EXTRACT(labels.folder_id)
        project_id: EXTRACT(labels.project_id)
  combiner: OR
  notification_channels:
  - ${notification_channel}
  alert_strategy:
    notification_rate_limit:
      period: 300s
    auto_close: 604800s