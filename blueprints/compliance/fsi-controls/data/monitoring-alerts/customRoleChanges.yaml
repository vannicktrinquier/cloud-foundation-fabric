customRoleChanges:
  alert_strategy:
    auto_close: 604800s
    notification_rate_limit:
      period: 300s
  combiner: OR
  conditions:
  - condition_matched_log:
      filter: "resource.type=\"iam_role\" AND  (\n  protoPayload.methodName=\"google.iam.admin.v1.CreateRole\"\
        \ OR \n  protoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR \n\
        \  protoPayload.methodName=\"google.iam.admin.v1.DeleteRole\"\n)"
      label_extractors:
        method_name: EXTRACT(protoPayload.methodName)
        organization_id: EXTRACT(labels.organization_id)
        principal: EXTRACT(protoPayload.authenticationInfo.principalEmail)
        project_id: EXTRACT(labels.project_id)
        role_name: EXTRACT(labels.role_name)
    display_name: 'Log match condition: custom role changes'
  display_name: Custom Role Changes
  documentation:
    content: "Log-based alerting policy in project ${project} detected custom IAM\
      \ role creation, deletion or update activities.\nThis alert helps ensure security\
      \ by monitoring changes to Identity and Access Management (IAM) roles. ```\n\
      \  resource.type=\"iam_role\" AND \n  (\n    protoPayload.methodName=\"google.iam.admin.v1.CreateRole\"\
      \ OR \n    protoPayload.methodName=\"google.iam.admin.v1.UpdateRole\" OR \n\
      \    protoPayload.methodName=\"google.iam.admin.v1.DeleteRole\"\n  )\n```"
    mime_type: text/markdown
  notification_channels:
  - projects/fsi-foundation-logging-d872/notificationChannels/14935710665502908194
